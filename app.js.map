{"version":3,"sources":["app.module.js","app.config.js","app.route.js","app.run.js","controllers/account.controller.js","controllers/home.controller.js","controllers/login.controller.js","controllers/spots.controller.js","controllers/tickets-add.controller.js","controllers/tickets.controller.js","directives/header.directive.js","services/auth.service.js","services/ticket.service.js","services/user.service.js"],"names":["angular","module","config","Config","serverUrl","factory","$inject","route","$stateProvider","$urlRouterProvider","otherwise","state","url","controller","controllerAs","templateUrl","resolve","currentAuth","auth","$requireAuth","$waitForAuth","views","@","run","$rootScope","$state","$on","event","toState","toParams","fromState","fromParams","error","pageName","go","AccountController","activate","vm","this","me","HomeController","console","log","LoginController","fbLogin","$authWithOAuthPopup","then","authData","uid","mailLogin","inputData","email","mailAddress","password","$createUser","userData","$authWithPassword","SpotsController","map","center","latitude","longitude","zoom","markers","id","title","TicketsAddController","ticket","add","$add","departureDate","arrivedDate","destination","languages","message","TicketsController","tickets","header","scope","HeaderController","bindToController","$onAuth","logout","confirm","$unauth","directive","$firebaseAuth","ref","Firebase","$firebaseArray","user"],"mappings":"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","file":"app.js","sourcesContent":["(function () {\n  'use strict';\n\n  angular.module('app', [\n    'ngAnimate',\n    'ui.router',\n    'uiGmapgoogle-maps',\n    'firebase'\n  ]);\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('config', config);\n\n  config.$inject = [];\n\n  function config() {\n    var Config = function () {\n      return {\n        'serverUrl': 'https://bandally.firebaseio.com/'\n      };\n    };\n    return new Config();\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').config(route);\n\n  route.$inject = ['$stateProvider', '$urlRouterProvider'];\n\n  function route($stateProvider, $urlRouterProvider) {\n    $urlRouterProvider.otherwise('/');\n    $stateProvider\n      .state('home', {\n        url: '/',\n        controller: 'HomeController',\n        controllerAs: 'home',\n        templateUrl: 'partials/home.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      })\n      .state('login', {\n        url: '/login',\n        controller: 'LoginController',\n        controllerAs: 'login',\n        templateUrl: 'partials/login.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$waitForAuth();\n          }]\n        }\n      })\n      .state('tickets', {\n        url: '/tickets',\n        controller: 'TicketsController',\n        controllerAs: 'tickets',\n        templateUrl: 'partials/tickets.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      })\n      .state('tickets.add', {\n        url: '/add',\n        views: {\n          \"@\": {\n            controller: 'TicketsAddController',\n            controllerAs: 'ticketsAdd',\n            templateUrl: 'partials/tickets-add.html'\n          }\n        },\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      })\n      .state('spots', {\n        url: '/spots',\n        controller: 'SpotsController',\n        controllerAs: 'spots',\n        templateUrl: 'partials/spots.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      })\n      .state('account', {\n        url: '/account',\n        controller: 'AccountController',\n        controllerAs: 'account',\n        templateUrl: 'partials/account.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      });\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').run(run);\n\n  run.$inject = ['$rootScope', '$state'];\n\n  function run($rootScope, $state) {\n    $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams, error) {\n      $rootScope.pageName = toState.controllerAs;\n    });\n    $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {\n      if (error === 'AUTH_REQUIRED') {\n        $state.go('login');\n      }\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('AccountController', AccountController);\n\n  AccountController.$inject = ['currentAuth'];\n\n  function AccountController(currentAuth) {\n\n    var vm = this;\n    vm.me = currentAuth;\n\n    activate();\n\n    function activate() {}\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('HomeController', HomeController);\n\n  HomeController.$inject = ['currentAuth'];\n\n  function HomeController(currentAuth) {\n\n    var vm = this;\n    vm.me = currentAuth;\n    console.log(currentAuth);\n\n    activate();\n\n    function activate() {}\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('LoginController', LoginController);\n\n  LoginController.$inject = ['$state', 'auth', 'currentAuth'];\n\n  function LoginController($state, auth, currentAuth) {\n\n    var vm = this;\n    vm.fbLogin = fbLogin;\n    vm.mailLogin = mailLogin;\n\n    activate();\n\n    function activate() {\n      if (currentAuth) {\n        $state.go('home');\n      }\n    }\n\n    function fbLogin() {\n      auth.$authWithOAuthPopup('facebook')\n        .then(function (authData) {\n          console.log('Logged in as:', authData.uid);\n          $state.go('home');\n        })\n        .catch(function (error) {\n          console.log('Authentication failed:', error);\n        });\n    }\n\n    function mailLogin() {\n      var inputData = {\n        email   : vm.mailAddress,\n        password: vm.password\n      };\n\n      auth.$createUser(inputData).then(function (userData) {\n        console.log(\"User \" + userData.uid + \" created successfully!\");\n        return auth.$authWithPassword(inputData);\n      }).then(function (authData) {\n        console.log(\"Logged in as:\", authData.uid);\n      }).catch(function (error) {\n        console.error(\"Error: \", error);\n      });\n      return;\n\n      // auth.$authWithPassword(inputData).then(function (authData) {\n      //   console.log(\"Logged in as:\", authData.uid);\n      //   $state.go('home');\n      // }).catch(function (error) {\n      //   if (error) {\n      //     auth.$createUser(inputData).then(function (userData) {\n      //       console.log(\"User \" + userData.uid + \" created successfully!\");\n      //       return auth.$authWithPassword(inputData);\n      //     }).then(function (authData) {\n      //       console.log(\"Logged in as:\", authData.uid);\n      //     }).catch(function (error) {\n      //       console.error(\"Error: \", error);\n      //     });\n      //   }\n      // });\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('SpotsController', SpotsController);\n\n  SpotsController.$inject = ['currentAuth'];\n\n  function SpotsController(currentAuth) {\n\n    var vm = this;\n    vm.me = currentAuth;\n    vm.map = {};\n    vm.markers = [];\n\n    activate();\n\n    function activate() {\n      vm.map = {\n        center: {\n          latitude: 35.457624,\n          longitude: 139.633337\n        },\n        zoom: 16\n      };\n      vm.markers = [\n        {\n          \"id\":1,\n          \"latitude\":35.459923,\n          \"longitude\":139.635290,\n          \"title\":\"パシフィコ横浜\"\n        },\n        {\n          \"id\":2,\n          \"latitude\":35.457511,\n          \"longitude\":139.632704,\n          \"title\":\"みなとみらい駅\"\n        }\n      ];\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('TicketsAddController', TicketsAddController);\n\n  TicketsAddController.$inject = ['$state', 'ticket'];\n\n  function TicketsAddController($state, ticket) {\n    var vm = this;\n    vm.add = add;\n\n    activate();\n\n    function activate() {}\n\n    function add() {\n      ticket.$add({\n        departureDate: vm.departureDate,\n        arrivedDate: vm.arrivedDate,\n        destination: vm.destination,\n        languages: vm.languages,\n        message: vm.message\n      }).then(function () {\n        $state.go('tickets');\n      });\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('TicketsController', TicketsController);\n\n  TicketsController.$inject = ['ticket'];\n\n  function TicketsController(ticket) {\n    var vm = this;\n    vm.tickets = [];\n\n    activate();\n\n    function activate() {\n      vm.tickets = ticket;\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').directive('header', header);\n\n  header.$inject = [];\n\n  function header() {\n    return {\n      templateUrl: 'partials/header.html',\n      scope: {},\n      controller: HeaderController,\n      controllerAs: 'header',\n      bindToController: true\n    };\n  }\n\n  HeaderController.$inject = ['$state', 'auth'];\n\n  function HeaderController($state, auth) {\n\n    var vm = this;\n    vm.auth = {};\n    vm.logout = logout;\n\n    activate();\n\n    function activate() {\n      auth.$onAuth(function (authData) {\n        vm.auth = authData;\n      });\n    }\n\n    function logout() {\n      if (!confirm('ログアウトします')) {\n        return;\n      }\n      auth.$unauth();\n      $state.go('login');\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('auth', auth);\n\n  auth.$inject = ['$firebaseAuth', 'config'];\n\n  function auth($firebaseAuth, config) {\n    var ref = new Firebase(config.serverUrl);\n    return $firebaseAuth(ref);\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('ticket', ticket);\n\n  ticket.$inject = ['$firebaseArray', 'config'];\n\n  function ticket($firebaseArray, config) {\n    var ref = new Firebase(config.serverUrl + 'tickets');\n    return $firebaseArray(ref);\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('user', user);\n\n  user.$inject = ['$firebaseAuth', 'config'];\n\n  function user($firebaseAuth, config) {\n    var ref = new Firebase(config.serverUrl + 'users');\n    return $firebaseAuth(ref);\n  }\n})();\n"],"sourceRoot":"/source/"}