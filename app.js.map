{"version":3,"sources":["app.module.js","app.config.js","app.route.js","app.run.js","controllers/login.controller.js","controllers/tickets-add.controller.js","controllers/tickets.controller.js","directives/header.directive.js","services/auth.service.js","services/ticket.service.js","services/user.service.js"],"names":["angular","module","config","serverUrl","value","$inject","route","$stateProvider","$urlRouterProvider","otherwise","state","url","controller","controllerAs","templateUrl","resolve","currentAuth","auth","$waitForAuth","$requireAuth","views","@","run","$rootScope","$state","$on","event","toState","toParams","fromState","fromParams","error","go","LoginController","activate","fbLogin","$authWithOAuthPopup","then","authData","console","log","uid","vm","this","TicketsAddController","ticket","add","$add","departureDate","arrivedDate","destination","languages","message","TicketsController","tickets","header","scope","HeaderController","bindToController","$onAuth","logout","confirm","$unauth","directive","$firebaseAuth","ref","Firebase","factory","$firebaseArray","user"],"mappings":"CAAA,WACA,YAEAA,SAAAC,OAAA,OACA,YACA,YACA,gBCNA,WACA,YAMA,SAAAC,KACA,OACAC,UAAA,sCANAH,QAAAC,OAAA,OAAAG,MAAA,SAAAF,GAEAA,EAAAG,cCLA,WACA,YAMA,SAAAC,GAAAC,EAAAC,GACAA,EAAAC,UAAA,KACAF,EACAG,MAAA,SACAC,IAAA,IACAC,WAAA,kBACAC,aAAA,QACAC,YAAA,sBACAC,SACAC,aAAA,OAAA,SAAAC,GACA,MAAAA,GAAAC,oBAIAR,MAAA,WACAC,IAAA,WACAC,WAAA,oBACAC,aAAA,UACAC,YAAA,wBACAC,SACAC,aAAA,OAAA,SAAAC,GACA,MAAAA,GAAAE,oBAIAT,MAAA,eACAC,IAAA,OACAS,OACAC,KACAT,WAAA,uBACAC,aAAA,aACAC,YAAA,8BAGAC,SACAC,aAAA,OAAA,SAAAC,GACA,MAAAA,GAAAE,oBAxCAnB,QAAAC,OAAA,OAAAC,OAAAI,GAEAA,EAAAD,SAAA,iBAAA,yBCLA,WACA,YAMA,SAAAiB,GAAAC,EAAAC,GACAD,EAAAE,IAAA,oBAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GACA,kBAAAA,GACAP,EAAAQ,GAAA,WAPAhC,QAAAC,OAAA,OAAAqB,IAAAA,GAEAA,EAAAjB,SAAA,aAAA,aCLA,WACA,YAMA,SAAA4B,GAAAT,EAAAP,EAAAD,GAOA,QAAAkB,KACAlB,GACAQ,EAAAQ,GAAA,WAIA,QAAAG,KACAlB,EAAAmB,oBAAA,YACAC,KAAA,SAAAC,GACAC,QAAAC,IAAA,gBAAAF,EAAAG,KACAjB,EAAAQ,GAAA,aAHAf,SAKA,SAAAc,GACAQ,QAAAC,IAAA,yBAAAT,KAlBA,GAAAW,GAAAC,IACAD,GAAAP,QAAAA,EAEAD,IATAlC,QAAAC,OAAA,OAAAW,WAAA,kBAAAqB,GAEAA,EAAA5B,SAAA,SAAA,OAAA,kBCLA,WACA,YAMA,SAAAuC,GAAApB,EAAAqB,GAMA,QAAAX,MAEA,QAAAY,KACAD,EAAAE,MACAC,cAAAN,EAAAM,cACAC,YAAAP,EAAAO,YACAC,YAAAR,EAAAQ,YACAC,UAAAT,EAAAS,UACAC,QAAAV,EAAAU,UACAf,KAAA,WACAb,EAAAQ,GAAA,aAfA,GAAAU,GAAAC,IACAD,GAAAI,IAAAA,EAEAZ,IARAlC,QAAAC,OAAA,OAAAW,WAAA,uBAAAgC,GAEAA,EAAAvC,SAAA,SAAA,aCLA,WACA,YAMA,SAAAgD,GAAAR,GAMA,QAAAX,KACAQ,EAAAY,QAAAT,EANA,GAAAH,GAAAC,IACAD,GAAAY,WAEApB,IARAlC,QAAAC,OAAA,OAAAW,WAAA,oBAAAyC,GAEAA,EAAAhD,SAAA,aCLA,WACA,YAMA,SAAAkD,KACA,OACAzC,YAAA,uBACA0C,SACA5C,WAAA6C,EACA5C,aAAA,SACA6C,kBAAA,GAMA,QAAAD,GAAAjC,EAAAP,GAQA,QAAAiB,KACAjB,EAAA0C,QAAA,SAAArB,GACAI,EAAAzB,KAAAqB,IAIA,QAAAsB,KACAC,QAAA,cAGA5C,EAAA6C,UACAtC,EAAAQ,GAAA,UAjBA,GAAAU,GAAAC,IACAD,GAAAzB,QACAyB,EAAAkB,OAAAA,EAEA1B,IAtBAlC,QAAAC,OAAA,OAAA8D,UAAA,SAAAR,GAEAA,EAAAlD,WAYAoD,EAAApD,SAAA,SAAA,WCjBA,WACA,YAMA,SAAAY,GAAA+C,EAAA9D,GACA,GAAA+D,GAAA,GAAAC,UAAAhE,IAAAC,UACA,OAAA6D,GAAAC,GANAjE,QAAAC,OAAA,OAAAkE,QAAA,OAAAlD,GAEAA,EAAAZ,SAAA,gBAAA,aCLA,WACA,YAMA,SAAAwC,GAAAuB,EAAAlE,GACA,GAAA+D,GAAA,GAAAC,UAAAhE,IAAAC,UAAA,UACA,OAAAiE,GAAAH,GANAjE,QAAAC,OAAA,OAAAkE,QAAA,SAAAtB,GAEAA,EAAAxC,SAAA,iBAAA,aCLA,WACA,YAMA,SAAAgE,GAAAL,EAAA9D,GACA,GAAA+D,GAAA,GAAAC,UAAAhE,IAAAC,UAAA,QACA,OAAA6D,GAAAC,GANAjE,QAAAC,OAAA,OAAAkE,QAAA,OAAAE,GAEAA,EAAAhE,SAAA,gBAAA","file":"app.js","sourcesContent":["(function () {\n  'use strict';\n\n  angular.module('app', [\n    'ngAnimate',\n    'ui.router',\n    'firebase'\n  ]);\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').value('config', config);\n\n  config.$inject = [];\n\n  function config() {\n    return {\n      'serverUrl': 'https://omotenashi.firebaseio.com/'\n    };\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').config(route);\n\n  route.$inject = ['$stateProvider', '$urlRouterProvider'];\n\n  function route($stateProvider, $urlRouterProvider) {\n    $urlRouterProvider.otherwise('/');\n    $stateProvider\n      .state('login', {\n        url: '/',\n        controller: 'LoginController',\n        controllerAs: 'login',\n        templateUrl: 'partials/login.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$waitForAuth();\n          }]\n        }\n      })\n      .state('tickets', {\n        url: '/tickets',\n        controller: 'TicketsController',\n        controllerAs: 'tickets',\n        templateUrl: 'partials/tickets.html',\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      })\n      .state('tickets.add', {\n        url: '/add',\n        views: {\n          \"@\": {\n            controller: 'TicketsAddController',\n            controllerAs: 'ticketsAdd',\n            templateUrl: 'partials/tickets-add.html'\n          }\n        },\n        resolve: {\n          currentAuth: ['auth', function(auth) {\n            return auth.$requireAuth();\n          }]\n        }\n      });\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').run(run);\n\n  run.$inject = ['$rootScope', '$state'];\n\n  function run($rootScope, $state) {\n    $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {\n      if (error === 'AUTH_REQUIRED') {\n        $state.go('login');\n      }\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('LoginController', LoginController);\n\n  LoginController.$inject = ['$state', 'auth', 'currentAuth'];\n\n  function LoginController($state, auth, currentAuth) {\n\n    var vm = this;\n    vm.fbLogin = fbLogin;\n\n    activate();\n\n    function activate() {\n      if (currentAuth) {\n        $state.go('tickets');\n      }\n    }\n\n    function fbLogin() {\n      auth.$authWithOAuthPopup('facebook')\n        .then(function (authData) {\n          console.log('Logged in as:', authData.uid);\n          $state.go('tickets');\n        })\n        .catch(function (error) {\n          console.log('Authentication failed:', error);\n        });\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('TicketsAddController', TicketsAddController);\n\n  TicketsAddController.$inject = ['$state', 'ticket'];\n\n  function TicketsAddController($state, ticket) {\n    var vm = this;\n    vm.add = add;\n\n    activate();\n\n    function activate() {}\n\n    function add() {\n      ticket.$add({\n        departureDate: vm.departureDate,\n        arrivedDate: vm.arrivedDate,\n        destination: vm.destination,\n        languages: vm.languages,\n        message: vm.message\n      }).then(function () {\n        $state.go('tickets');\n      });\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').controller('TicketsController', TicketsController);\n\n  TicketsController.$inject = ['ticket'];\n\n  function TicketsController(ticket) {\n    var vm = this;\n    vm.tickets = [];\n\n    activate();\n\n    function activate() {\n      vm.tickets = ticket;\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').directive('header', header);\n\n  header.$inject = [];\n\n  function header() {\n    return {\n      templateUrl: 'partials/header.html',\n      scope: {},\n      controller: HeaderController,\n      controllerAs: 'header',\n      bindToController: true\n    };\n  }\n\n  HeaderController.$inject = ['$state', 'auth'];\n\n  function HeaderController($state, auth) {\n\n    var vm = this;\n    vm.auth = {};\n    vm.logout = logout;\n\n    activate();\n\n    function activate() {\n      auth.$onAuth(function (authData) {\n        vm.auth = authData;\n      });\n    }\n\n    function logout() {\n      if (!confirm('ログアウトします')) {\n        return;\n      }\n      auth.$unauth();\n      $state.go('login');\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('auth', auth);\n\n  auth.$inject = ['$firebaseAuth', 'config'];\n\n  function auth($firebaseAuth, config) {\n    var ref = new Firebase(config().serverUrl);\n    return $firebaseAuth(ref);\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('ticket', ticket);\n\n  ticket.$inject = ['$firebaseArray', 'config'];\n\n  function ticket($firebaseArray, config) {\n    var ref = new Firebase(config().serverUrl + 'tickets');\n    return $firebaseArray(ref);\n  }\n})();\n","(function () {\n  'use strict';\n\n  angular.module('app').factory('user', user);\n\n  user.$inject = ['$firebaseAuth', 'config'];\n\n  function user($firebaseAuth, config) {\n    var ref = new Firebase(config().serverUrl + 'users');\n    return $firebaseAuth(ref);\n  }\n})();\n"],"sourceRoot":"/source/"}